@model List<BerretDecailletBookingGUI.ViewModel.RoomSelectedVM>
@using System.Web.Mvc.Html;

@{ 
    ViewBag.Title = "Available rooms";
    string roomTypeIcon = "";
    string roomTypeTooltip = "";
    string tvColorIcon = "";
    string tvTooltip = "";
    string hairdryerColorIcon = "";
    string hairdryerTooltip = "";
    int roomPos = 0;
}

@using (Html.BeginForm("Create", "Reservations", FormMethod.Post))
{
    <div class="fixed-action-btn">
        <button class="btn-floating btn-large waves-effect waves-light red" type="submit"><i class="material-icons">send</i></button>
    </div>

    var i = 0;
    for (i = 0; i < Model.Count; i++)
    {
        bool HasTV = (Model[i].Room.HasTV == null) ? false : (bool)Model[i].Room.HasTV;
        bool HasHairdryer = (Model[i].Room.HasHairdryer == null) ? false : (bool)Model[i].Room.HasHairdryer;

        roomTypeIcon = (Model[i].Room.Type == 1) ? "person" : "people";
        roomTypeTooltip = (Model[i].Room.Type == 1) ? "Single" : "Double";
        tvColorIcon = HasTV ? "text-darken-3" : "text-lighten-2";
        tvTooltip = HasTV ? "Has TV" : "No TV";
        hairdryerColorIcon = HasHairdryer ? "text-darken-3" : "text-lighten-2";
        hairdryerTooltip = HasHairdryer ? "Has hairdryer" : "No hairdryer";

        if (i % 3 == 0)
        {
            @Html.Raw("<div class='row'>")
        }
        
        @Html.HiddenFor(m => m[i].CheckIn)
        @Html.HiddenFor(m => m[i].CheckOut)

        <div class="col s4">
            <div class="card horizontal">
                <div class="card-image">
                    <img src="https://lorempixel.com/100/190/nature/6">
                </div>
                <div class="card-stacked">
                    <div class="card-content">
                        <span>@Html.ActionLink(Model[i].Room.Hotel.Name, "Details", "Hotels", new { id = Model[i].Room.Hotel.IdHotel}, new { @class = "card-title" }) </span>
                        <div class="divider"></div>
                        <div class="section">
                            <p>@Html.DisplayFor(m => m[i].Room.Description)</p>
                        </div>
                        <div class="row">
                            <div class="col s4 center-align">
                                <p><i class="tiny material-icons grey-text text-darken-3 tooltipped" data-position="top" data-delay="50" data-tooltip="@Html.Raw(roomTypeTooltip)">@Html.Raw(roomTypeIcon)</i></p>
                            </div>
                            <div class="col s4 center-align">
                                <p><i class="tiny material-icons grey-text @Html.Raw(tvColorIcon) tooltipped" data-position="top" data-delay="50" data-tooltip="@Html.Raw(tvTooltip)">tv</i></p>
                            </div>
                            <div class="col s4 center-align">
                                <p><i class="tiny material-icons grey-text @Html.Raw(hairdryerColorIcon) tooltipped" data-position="top" data-delay="50" data-tooltip="@Html.Raw(hairdryerTooltip)">local_offer</i></p>
                            </div>
                        </div>
                        <p class="center-align"><i class="material-icons grey-text text-darken-3">attach_money</i> @Html.DisplayFor(m => m[i].Room.Price) CHF</p>
                    </div>
                    <div class="card-action">
                        <p>
                            @Html.CheckBoxFor(m => m[i].IsSelected, htmlAttributes : new { id = "room"+i })
                            @Html.HiddenFor(m => m[i].Room.IdRoom)
                            @Html.Label("room"+i.ToString(), "Select")
                        </p>
                    </div>
                </div>
            </div>
        </div>

        roomPos++;
        if (roomPos % 3 == 0)
        {
        <!-- Close last row -->
            @Html.Raw("</div>")
        }
    }


    if (roomPos % 3 != 0)
    {
    <!-- Close last row -->
        @Html.Raw("</div>")
    }
}

@section scripts{
    <script>
        $(document).ready(function () {
            // workaround for checkbox in materialize
            $("input[type='hidden']").each(function (index, element) {
                $(this).appendTo($(element).parent());
            });
        });
        
    </script>
    }